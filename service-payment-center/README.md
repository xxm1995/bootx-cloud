# 支付中心(9007)

## 主要功能
1. 统一支付
2. 分账记账


## 核心概念
- Payment 主支付记录: 用于记录当前支付的公共信息，同时每个不同的支付方式都有对应的子payment，比如：AliPayPayment，WeChatPayment，PointPayment等
- PayMode 支付方式 一个PayMode表示一种支付方式，PayMode包含支付类型和支付金额,以及支付扩展参数。
- OrderBilling 账单，每个PayMode生成一个账单。
- OrderBillingItem 账单项 每个支付的项都会在其支持的PayMode下面生成一个对应的账单项。

## 核心业务


账单更换或重新发起异步支付方式，发起支付参数必传businessId, 然后对应的payMode和对应的支付参数(Alipay等)


## TODO
- [ ] 加入商户和应用系统
    - [x] 商户下属可以有多个应用
    - [x] 应用有独立的支付方式配置
    - [x] 可配置指定的渠道状态
    - [X] 可配置渠道下指定可用的支付方式
- [ ] 支付系统重构
    - [x] 去除业务耦合部分
    - [x] 增加标题、描述
    - [x] 支付通道初始化重构
    - [x] 支付时获取支付通道重构
    - [x] 增加支付时检查通道合法性
    - [X] 增加支付时检查通道下属支付方式可用性
- [ ] 账务系统重构
    - [ ] 账务拆分,不在与支付耦合
    - [ ] 分账时,对订单金额合法进行校验
- [ ] 支付通道配置
    - [x] 通道配置
    - [x] 通道支付方式配置
    - [ ] 配置超时时间
    
